import requests
import socket
import platform
import ctypes
import sys

def VMCheck():
    system_info = platform.system().lower()
    
    vm_strings = ['vmware', 'virtual', 'hypervisor', 'xen']
    for vm_string in vm_strings:
        if vm_string in system_info:
            return True
    
    return False

def GetIP():
    hostname = socket.gethostname()
    IPAddr = socket.gethostbyname(hostname)

    return IPAddr

def GetAdmin():
    try:
        isAdmin = ctypes.windll.shell32.IsUserAnAdmin()
    except AttributeError:
        isAdmin = False
    if not isAdmin:
        ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, __file__, None, 1)

def CheckAdmin():
    try:
        isAdmin = ctypes.windll.shell32.IsUserAnAdmin()
    except Exception:
        isAdmin = False
    if not isAdmin:
        return False
    else:
        return True

def KillSwitch(KillSwitchURL):
    try:
        response = requests.get(KillSwitchURL)
        response.raise_for_status()
        exit()
    except requests.exceptions.RequestException:
        pass